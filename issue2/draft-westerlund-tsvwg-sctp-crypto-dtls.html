<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Datagram Transport Layer Security (DTLS) in the Stream Control Transmission Protocol (SCTP) CRYPTO Chunk</title>
<meta content="Magnus Westerlund" name="author">
<meta content="John Preuß Mattsson" name="author">
<meta content="Claudio Porfiri" name="author">
<meta content="
       This document defines a usage of Datagram Transport Layer Security (DTLS)
1.2 or 1.3 to protect the content of Stream Control Transmission Protocol
(SCTP) packets using the framework provided by the SCTP
CRYPTO chunk which we name DTLS in SCTP. DTLS in SCTP provides
encryption, source authentication, integrity and replay protection for
the SCTP association with mutual authentication of the peers. The
specification is also targeting very long-lived sessions of weeks and
months and supports mutual re-authentication and rekeying with ephemeral
key exchange. This is intended as an alternative to using DTLS/SCTP (RFC
6083) and SCTP-AUTH (RFC 4895). 
    " name="description">
<meta content="xml2rfc 3.17.3" name="generator">
<meta content="draft-westerlund-tsvwg-sctp-crypto-dtls-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.17.3
    Python 3.11.4
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.2
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.31.0
    setuptools 67.7.2
    six 1.16.0
    wcwidth 0.2.6
-->
<link href="draft-westerlund-tsvwg-sctp-crypto-dtls.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">DTLS in SCTP</td>
<td class="right">June 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">Westerlund, et al.</td>
<td class="center">Expires 29 December 2023</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">TSVWG</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-westerlund-tsvwg-sctp-crypto-dtls-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2023-06-27" class="published">27 June 2023</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2023-12-29">29 December 2023</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Westerlund</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">J. Preuß Mattsson</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">C. Porfiri</div>
<div class="org">Ericsson</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Datagram Transport Layer Security (DTLS) in the Stream Control Transmission Protocol (SCTP) CRYPTO Chunk</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines a usage of Datagram Transport Layer Security (DTLS)
1.2 or 1.3 to protect the content of Stream Control Transmission Protocol
(SCTP) packets using the framework provided by the SCTP
CRYPTO chunk which we name DTLS in SCTP. DTLS in SCTP provides
encryption, source authentication, integrity and replay protection for
the SCTP association with mutual authentication of the peers. The
specification is also targeting very long-lived sessions of weeks and
months and supports mutual re-authentication and rekeying with ephemeral
key exchange. This is intended as an alternative to using DTLS/SCTP (RFC
6083) and SCTP-AUTH (RFC 4895).<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-westerlund-tsvwg-sctp-crypto-dtls/">https://datatracker.ietf.org/doc/draft-westerlund-tsvwg-sctp-crypto-dtls/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Transport Area Working Group (tsvwg) Working Group mailing list (<span><a href="mailto:tsvwg@ietf.org">mailto:tsvwg@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/tsvwg/">https://mailarchive.ietf.org/arch/browse/tsvwg/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/tsvwg/">https://www.ietf.org/mailman/listinfo/tsvwg/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/gloinul/draft-westerlund-tsvwg-sctp-crypto-dtls">https://github.com/gloinul/draft-westerlund-tsvwg-sctp-crypto-dtls</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 29 December 2023.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2023 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-overview" class="internal xref">Overview</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-protocol-overview" class="internal xref">Protocol Overview</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1"><a href="#section-1.3" class="auto internal xref">1.3</a>.  <a href="#name-properties-of-dtls-in-sctp" class="internal xref">Properties of DTLS in SCTP</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3.2.1">
                    <p id="section-toc.1-1.1.2.3.2.1.1" class="keepWithNext"><a href="#section-1.3.1" class="auto internal xref">1.3.1</a>.  <a href="#name-benefits-compared-to-dtls-s" class="internal xref">Benefits Compared to DTLS/SCTP</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a href="#section-1.4" class="auto internal xref">1.4</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5">
                <p id="section-toc.1-1.1.2.5.1"><a href="#section-1.5" class="auto internal xref">1.5</a>.  <a href="#name-abbreviations" class="internal xref">Abbreviations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.6">
                <p id="section-toc.1-1.1.2.6.1"><a href="#section-1.6" class="auto internal xref">1.6</a>.  <a href="#name-conventions" class="internal xref">Conventions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-dtls-identification" class="internal xref">DTLS Identification</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-new-protection-engines-prot" class="internal xref">New protection Engines {protection-engines}</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-dtls-usage-of-crypto-chunk" class="internal xref">DTLS Usage of CRYPTO Chunk</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-crypto-chunk-integration" class="internal xref">Crypto Chunk Integration</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-state-machine" class="internal xref">State Machine</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="auto internal xref">4.1.1</a>.  <a href="#name-protection-pending-state" class="internal xref">PROTECTION PENDING state</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="auto internal xref">4.1.2</a>.  <a href="#name-protected-state" class="internal xref">PROTECTED state</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.3">
                    <p id="section-toc.1-1.4.2.1.2.3.1"><a href="#section-4.1.3" class="auto internal xref">4.1.3</a>.  <a href="#name-shutdown-states" class="internal xref">SHUTDOWN states</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-dtls-connection-handling" class="internal xref">DTLS Connection Handling</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="auto internal xref">4.2.1</a>.  <a href="#name-add-a-new-dtls-connection" class="internal xref">Add a New DTLS Connection</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="auto internal xref">4.2.2</a>.  <a href="#name-remove-an-existing-dtls-con" class="internal xref">Remove an existing DTLS Connection</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-error-cases" class="internal xref">Error Cases</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-dtls-considerations" class="internal xref">DTLS Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-version-of-dtls" class="internal xref">Version of DTLS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-configuration-of-dtls" class="internal xref">Configuration of DTLS</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="auto internal xref">5.2.1</a>.  <a href="#name-general" class="internal xref">General</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="auto internal xref">5.2.2</a>.  <a href="#name-authentication-and-policy-d" class="internal xref">Authentication and Policy Decisions</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3">
                    <p id="section-toc.1-1.5.2.2.2.3.1"><a href="#section-5.2.3" class="auto internal xref">5.2.3</a>.  <a href="#name-new-connections" class="internal xref">New Connections</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.4">
                    <p id="section-toc.1-1.5.2.2.2.4.1"><a href="#section-5.2.4" class="auto internal xref">5.2.4</a>.  <a href="#name-padding-of-dtls-records" class="internal xref">Padding of DTLS Records</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.5">
                    <p id="section-toc.1-1.5.2.2.2.5.1"><a href="#section-5.2.5" class="auto internal xref">5.2.5</a>.  <a href="#name-dtls-12" class="internal xref">DTLS 1.2</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.6">
                    <p id="section-toc.1-1.5.2.2.2.6.1"><a href="#section-5.2.6" class="auto internal xref">5.2.6</a>.  <a href="#name-dtls-13" class="internal xref">DTLS 1.3</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-establishing-dtls-in-sctp" class="internal xref">Establishing DTLS in SCTP</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-dtls-handshake" class="internal xref">DTLS Handshake</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="auto internal xref">6.1.1</a>.  <a href="#name-handshake-of-initial-dtls-c" class="internal xref">Handshake of initial DTLS connection</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1.2.2">
                    <p id="section-toc.1-1.6.2.1.2.2.1"><a href="#section-6.1.2" class="auto internal xref">6.1.2</a>.  <a href="#name-handshake-of-further-dtls-c" class="internal xref">Handshake of further DTLS connections</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-validation-against-downgrad" class="internal xref">Validation Against Downgrade Attacks</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-processing-a-crypto-chunk" class="internal xref">Processing a CRYPTO Chunk</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-sending" class="internal xref">Sending</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-receiving" class="internal xref">Receiving</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-parallel-dtls-rekeying" class="internal xref">Parallel DTLS Rekeying</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-criteria-for-rekeying" class="internal xref">Criteria for Rekeying</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-procedure-for-rekeying" class="internal xref">Procedure for Rekeying</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-race-condition-in-rekeying" class="internal xref">Race Condition in Rekeying</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-pmtu-discovery-consideratio" class="internal xref">PMTU Discovery Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-general-2" class="internal xref">General</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-iana-consideration" class="internal xref">IANA Consideration</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-protection-engine-registrat" class="internal xref">Protection Engine Registration</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref">12.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="auto internal xref">12.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<div id="overview">
<section id="section-1.1">
        <h3 id="name-overview">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
        </h3>
<p id="section-1.1-1">This document describes the usage of the Datagram Transport Layer
   Security (DTLS) protocol, as defined in DTLS 1.2 <span>[<a href="#RFC6347" class="cite xref">RFC6347</a>]</span>, and
   DTLS 1.3 <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span>, as protection engine in the Stream Control
   Transmission Protocol (SCTP), as defined in <span>[<a href="#RFC9260" class="cite xref">RFC9260</a>]</span> with SCTP
   CRYPTO chunk <span>[<a href="#I-D.westerlund-tsvwg-sctp-crypto-chunk" class="cite xref">I-D.westerlund-tsvwg-sctp-crypto-chunk</a>]</span>.  This
   specification is intended as an alternative to DTLS/SCTP <span>[<a href="#RFC6083" class="cite xref">RFC6083</a>]</span>
   and usage of SCTP-AUTH <span>[<a href="#RFC4895" class="cite xref">RFC4895</a>]</span>.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">This specification provides mutual authentication of endpoints,
   data confidentiality, data origin authentication, data integrity
   protection, and data replay protection of SCTP packets. Ensuring
   these security services to the application and its upper layer
   protocol over SCTP.  Thus, it allows client/server applications to
   communicate in a way that is designed with communications
   privacy and preventing eavesdropping and detect tampering or
   message forgery.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">Applications using DTLS in SCTP can use all currently existing
   transport features provided by SCTP and its extensions, in some
   cases with some limitations, as specified in
   <span>[<a href="#I-D.westerlund-tsvwg-sctp-crypto-chunk" class="cite xref">I-D.westerlund-tsvwg-sctp-crypto-chunk</a>]</span>. DTLS in SCTP supports:<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-4.1">preservation of message boundaries.<a href="#section-1.1-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.2">no limitation on number of unidirectional and bidirectional streams.<a href="#section-1.1-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.3">ordered and unordered delivery of SCTP user messages.<a href="#section-1.1-4.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.4">the partial reliability extension as defined in <span>[<a href="#RFC3758" class="cite xref">RFC3758</a>]</span>.<a href="#section-1.1-4.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.5">multi-homing of the SCTP association per <span>[<a href="#RFC9260" class="cite xref">RFC9260</a>]</span>.<a href="#section-1.1-4.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.6">the dynamic address reconfiguration extension as defined in
 <span>[<a href="#RFC5061" class="cite xref">RFC5061</a>]</span>.<a href="#section-1.1-4.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.7">User messages of any size.<a href="#section-1.1-4.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.8">SCTP Packets with a protected set of chunks up to a size of
2<sup>14</sup> bytes.<a href="#section-1.1-4.8" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="protocol-overview">
<section id="section-1.2">
        <h3 id="name-protocol-overview">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-protocol-overview" class="section-name selfRef">Protocol Overview</a>
        </h3>
<p id="section-1.2-1">DTLS in SCTP is a protection engine specification for the SCTP
   CRYPTO chunk <span>[<a href="#I-D.westerlund-tsvwg-sctp-crypto-chunk" class="cite xref">I-D.westerlund-tsvwg-sctp-crypto-chunk</a>]</span> that
   utilizes DTLS 1.2 or 1.3 for the security functions like
   key exchange, authentication, encryption, integrity protection,
   and replay protection. The basic functionalities and how things
   are related are described below.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">In a SCTP association initiation where DTLS in SCTP is chosen as
   the protection engine for the CRYPTO chunk the DTLS handshake
   is exchanged encapsulated in plain DATA chunks with Protection
   Engine PPID (see section 10.6 of <span>[<a href="#I-D.westerlund-tsvwg-sctp-crypto-chunk" class="cite xref">I-D.westerlund-tsvwg-sctp-crypto-chunk</a>]</span>)
   until an initial DTLS connection has been established.
   If the DTLS handshake fails, the
   SCTP association is aborted. When the DTLS connection has been
   established PVALID chunks are exchanged to verify that no
   downgrade attack between different protection engines has
   occurred. To prevent manipulation, the PVALID chunks are protected
   by encapsulating them in DTLS protected CRYPTO chunks.<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<p id="section-1.2-3">Assuming that the PVALID validation is successful the SCTP
   association is established and the Upper Layer Protocol (ULP) can
   start sending data over the SCTP association. From this point all
   chunks will be protected by encapsulating them in DTLS protected
   CRYPTO chunks. The SCTP chunks to be included in an SCTP packet
   are the plain text application data input to DTLS. The
   encrypted DTLS application data record is then encapsulated in the
   CRYPTO chunk and the packet is transmitted, see <a href="#chunk-processing" class="auto internal xref">Section 7</a>.<a href="#section-1.2-3" class="pilcrow">¶</a></p>
<p id="section-1.2-4">In the receiving SCTP endpoint each incoming SCTP packet on any of
   its interfaces and ports are matched to the SCTP association based
   on ports and VTAG in the common header. In that association context
   for the CRYPTO chunk there will exist reference to one or more DTLS
   connections used to protect the data. The DTLS connection actually
   used to protect this packet is identified by two DCI bits in the
   CRYPTO chunk's flags. Using the identified DTLS session the content
   of the CRYPTO chunk is attempted to be processed, including replay
   protection, decryption, and integrity checking. And if decryption
   and integrity verification was successful the produced plain text
   of one or more SCTP chunks are provided for normal SCTP processing
   in the identified SCTP association along with associated meta data
   such as path received on, original packet size, and ECN bits.<a href="#section-1.2-4" class="pilcrow">¶</a></p>
<p id="section-1.2-5">When mutual re-authentication or rekeying with ephemeral key exchange is
   needed or desired by either endpoint a new DTLS connection handshake
   is performed between the SCTP endpoints. A different DTLS Connection
   Index (DCI) than currently used among the CRYPTO chunk flags are used to
   indicate that this is a new handshake. When the handshake has
   completed the DTLS in SCTP implementation can simply switch to use
   this DTLS connection to protect the plain text payload. After a
   short while (no longer than 2 min) to enable any outstanding
   packets to drain from the network path between the endpoints the
   old DTLS connection can be terminated.<a href="#section-1.2-5" class="pilcrow">¶</a></p>
<p id="section-1.2-6">The DTLS connection is free to send any alert, handshake message, or
   other non-application data to its peer at any point in time. Thus,
   enabling DTLS 1.3 Key Updates for example.
   All non-application data SHOULD be sent by means of SCTP DATA chunks
   with Protection Engine PPID as specified in
   <span>[<a href="#I-D.westerlund-tsvwg-sctp-crypto-chunk" class="cite xref">I-D.westerlund-tsvwg-sctp-crypto-chunk</a>]</span>.<a href="#section-1.2-6" class="pilcrow">¶</a></p>
<span id="name-dtls-in-sctp-layer-in-regar"></span><div id="overview-layering">
<figure id="figure-1">
          <div id="section-1.2-7.1">
            <div class="alignLeft art-svg artwork" id="section-1.2-7.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="352" width="448" viewBox="0 0 448 352" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px">
                <path d="M 8,32 L 8,336" fill="none" stroke="black"></path>
                <path d="M 136,32 L 136,96" fill="none" stroke="black"></path>
                <path d="M 152,32 L 152,96" fill="none" stroke="black"></path>
                <path d="M 184,96 L 184,336" fill="none" stroke="black"></path>
                <path d="M 224,208 L 224,272" fill="none" stroke="black"></path>
                <path d="M 320,32 L 320,96" fill="none" stroke="black"></path>
                <path d="M 400,208 L 400,272" fill="none" stroke="black"></path>
                <path d="M 440,80 L 440,224" fill="none" stroke="black"></path>
                <path d="M 8,32 L 136,32" fill="none" stroke="black"></path>
                <path d="M 152,32 L 320,32" fill="none" stroke="black"></path>
                <path d="M 320,64 L 424,64" fill="none" stroke="black"></path>
                <path d="M 8,96 L 320,96" fill="none" stroke="black"></path>
                <path d="M 336,128 L 352,128" fill="none" stroke="black"></path>
                <path d="M 200,176 L 216,176" fill="none" stroke="black"></path>
                <path d="M 8,208 L 184,208" fill="none" stroke="black"></path>
                <path d="M 224,208 L 400,208" fill="none" stroke="black"></path>
                <path d="M 192,240 L 216,240" fill="none" stroke="black"></path>
                <path d="M 408,240 L 424,240" fill="none" stroke="black"></path>
                <path d="M 8,272 L 184,272" fill="none" stroke="black"></path>
                <path d="M 224,272 L 400,272" fill="none" stroke="black"></path>
                <path d="M 200,304 L 216,304" fill="none" stroke="black"></path>
                <path d="M 8,336 L 184,336" fill="none" stroke="black"></path>
                <path d="M 184,272 L 200,304" fill="none" stroke="black"></path>
                <path d="M 320,96 L 336,128" fill="none" stroke="black"></path>
                <path d="M 184,208 L 200,176" fill="none" stroke="black"></path>
                <path d="M 424,64 C 432.83064,64 440,71.16936 440,80" fill="none" stroke="black"></path>
                <path d="M 424,240 C 432.83064,240 440,232.83064 440,224" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="416,240 404,234.4 404,245.6" fill="black" transform="rotate(180,408,240)"></polygon>
                <polygon class="arrowhead" points="224,240 212,234.4 212,245.6" fill="black" transform="rotate(0,216,240)"></polygon>
                <polygon class="arrowhead" points="200,240 188,234.4 188,245.6" fill="black" transform="rotate(180,192,240)"></polygon>
                <g class="text">
                  <text x="204" y="52">Protection</text>
                  <text x="276" y="52">Engine</text>
                  <text x="356" y="52">Keys</text>
                  <text x="72" y="68">ULP</text>
                  <text x="192" y="84">Key</text>
                  <text x="252" y="84">Management</text>
                  <text x="380" y="116">User</text>
                  <text x="384" y="132">Level</text>
                  <text x="36" y="148">SCTP</text>
                  <text x="84" y="148">Chunks</text>
                  <text x="144" y="148">Handler</text>
                  <text x="396" y="148">Messages</text>
                  <text x="244" y="180">SCTP</text>
                  <text x="312" y="180">Unprotected</text>
                  <text x="392" y="180">Payload</text>
                  <text x="100" y="228">CRYPTO</text>
                  <text x="276" y="228">Protection</text>
                  <text x="348" y="228">Engine</text>
                  <text x="96" y="244">Chunk</text>
                  <text x="96" y="260">Handler</text>
                  <text x="276" y="260">Protection</text>
                  <text x="356" y="260">Operator</text>
                  <text x="36" y="308">SCTP</text>
                  <text x="84" y="308">Header</text>
                  <text x="144" y="308">Handler</text>
                  <text x="244" y="308">DTLS</text>
                  <text x="304" y="308">Encrypted</text>
                  <text x="364" y="308">SCTP</text>
                  <text x="416" y="308">Payload</text>
                </g>
              </svg><a href="#section-1.2-7.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-dtls-in-sctp-layer-in-regar" class="selfRef">DTLS in SCTP layer in regard to SCTP and upper layer protocol</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="properties-of-dtls-in-sctp">
<section id="section-1.3">
        <h3 id="name-properties-of-dtls-in-sctp">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-properties-of-dtls-in-sctp" class="section-name selfRef">Properties of DTLS in SCTP</a>
        </h3>
<p id="section-1.3-1">DTLS in SCTP has a number of properties that are attractive.<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.3-2.1">Provides confidentiality, integrity protection, and source
authentication for each packet.<a href="#section-1.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.2">Provides replay protection on SCTP packet level preventing
malicious replay attacks on SCTP, both protecting the data as well
as the SCTP functions themselves.<a href="#section-1.3-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.3">Provides mutual authentication of the endpoints based on any
authentication mechanism supported by DTLS.<a href="#section-1.3-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.4">Uses parallel DTLS connections to enable mutual re-authentication
and rekeying with ephemeral key exchange. Thus, enabling SCTP association
lifetimes without known limitations.<a href="#section-1.3-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.5">Uses core of DTLS as it is and updates and fixes to DTLS security
properties can be implemented without further changes to this
specification.<a href="#section-1.3-2.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.6">Secures all SCTP packets exchanged after SCTP association has
reached the established state. Making targeted attacks against
the SCTP protocol and implementation much harder.<a href="#section-1.3-2.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.7">DTLS in SCTP results in no limitations on user message
transmission, those properties are the same as for an unprotected
SCTP association.<a href="#section-1.3-2.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.8">Limited overhead on a per packet basis, with 4 bytes for the
CRYPTO chunk plus the DTLS record overhead. The DTLS
overhead is dependent on the DTLS version.<a href="#section-1.3-2.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.9">Support of SCTP packet plain text payload sizes up to
2<sup>14</sup> bytes.<a href="#section-1.3-2.9" class="pilcrow">¶</a>
</li>
        </ul>
<div id="benefits-compared-to-dtlssctp">
<section id="section-1.3.1">
          <h4 id="name-benefits-compared-to-dtls-s">
<a href="#section-1.3.1" class="section-number selfRef">1.3.1. </a><a href="#name-benefits-compared-to-dtls-s" class="section-name selfRef">Benefits Compared to DTLS/SCTP</a>
          </h4>
<p id="section-1.3.1-1">DTLS/SCTP as defined by <span>[<a href="#I-D.ietf-tsvwg-dtls-over-sctp-bis" class="cite xref">I-D.ietf-tsvwg-dtls-over-sctp-bis</a>]</span>
   has several important differences most to the benefit of DTLS in
   SCTP. This section reviews these differences.<a href="#section-1.3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.3.1-2.1">Replay Protection in DTLS/SCTP has some limitations due to
SCTP-AUTH <span>[<a href="#RFC4895" class="cite xref">RFC4895</a>]</span> and its interaction with the SCTP implementation and
dependencies on the actual SCTP-AUTH rekeying frequency. DTLS
in SCTP relies on DTLS mechanism for replay protection that can
prevent both duplicates from being delivered as well as
preventing packets from outside the current window to be
delivered. Thus, a stronger protection especially for non-DATA
chunk are provided and protects the SCTP stack from replayed or
duplicated packets.<a href="#section-1.3.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.3.1-2.2">Encryption in DTLS/SCTP is only applied to ULP data. For
DTLS in SCTP all chunk type after the association has reached
established state will be encrypted. This, makes protocol attacks
harder as a third-party attacker will have less insight into SCTP
protocol state. Also, protocol header information likes PPIDs will
also be encrypted, which makes targeted attacks harder but also
make management and debugging harder.<a href="#section-1.3.1-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.3.1-2.3">DTLS/SCTP Rekeying is complicated and require advanced API or
user message tracking to determine when a key is no longer needed
so that it can be discarded. A DTLS/SCTP key that is prematurely
discarded can result in loss of parts of a user message and
failure of the assumptions on the transport where the sender
believes it delivered and the receiver never gets it. This
usually will result in the need to terminate the SCTP association
to restart the ULP session to avoid worse issues. DTLS in SCTP is
robust to discarding the DTLS key after having switched to a new
established DTLS connection. Any outstanding packets that have
not been decoded yet will simply be treated as lost between the
SCTP endpoints and SCTP's retransmission will retransmit any user
message data that requires it. Also, the algorithm for when to
discard a DTLS connection can be much simpler.<a href="#section-1.3.1-2.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.3.1-2.4">DTLS/SCTP rekeying can put restrictions on user message sizes
unless the right APIs exist to the SCTP implementation to
determine the state of user messages. No such restriction exists
in DTLS in SCTP.<a href="#section-1.3.1-2.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.3.1-2.5">By using the CRYPTO chunk that is acting on SCTP packet level
instead of user messages the consideration for extensions are
quite different. Only extensions that would affect the common
header or how packets are formed would interact with this
mechanism, any extension that just defines new chunks or
parameters for existing chunks is expected to just work and be
secured by the mechanism. DTLS/SCTP instead interact with
extensions that affects how user messages are handled.<a href="#section-1.3.1-2.5" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.3.1-2.6">A known downside is that the defined DTLS in SCTP usage creates a
limitation on the maximum SCTP packet size that can be used of
2<sup>14</sup> bytes. If the DTLS implementation does not support
the maximum DTLS record size the maximum supported packet size
might be even lower. However, this value needs to be compared to
the supported MTU of IP, and are thus in reality often not an
actual limitation. Only for some special deployments or over
loopback may this limitation be visible.<a href="#section-1.3.1-2.6" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-1.3.1-3">There are several significant differences in regard to
   implementation between the two realizations.<a href="#section-1.3.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.3.1-4.1">DTLS in SCTP do requires the CRYPTO chunk to be implemented in
the SCTP stack implementation, and not as an adaptation layer
above the SCTP stack which DTLS/SCTP instead requires. This has
some extra challenges for operating system level
implementations. However, as some updates anyway will be required
to support the corrected SCTP-AUTH the implementation burden is
likely similar in this regard.<a href="#section-1.3.1-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-1.3.1-4.2">
              <p id="section-1.3.1-4.2.1">DTLS in SCTP can use a DTLS implementation that does not rely on
features from outside of the core protocol, where DTLS/SCTP
required a number of features as listed below:<a href="#section-1.3.1-4.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.3.1-4.2.2.1">DTLS Connection Index to identify which DTLS connection that
should process the DTLS record.<a href="#section-1.3.1-4.2.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-1.3.1-4.2.2.2">Support for DTLS records of the maximum size of 16 KB.<a href="#section-1.3.1-4.2.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-1.3.1-4.2.2.3">Optional to support negotiation of maximum DTLS record size
unless not supporting 16 KB records when it is
required. Even if implementing the negotiation,
interoperability failure may occur. DTLS in SCTP will only
require supporting DTLS record sizes that matches the
largest IP packet size that endpoint support or the SCTP
implementation.<a href="#section-1.3.1-4.2.2.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-1.3.1-4.2.2.4">Implementation is required to support turning off the DTLS
replay protection.<a href="#section-1.3.1-4.2.2.4" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-1.3.1-4.2.2.5">Implementation is required to not use DTLS Key-update
functionality. Where DTLS in SCTP is agnostic to its usage,
and it provides a useful tool to ensure that the key lifetime
never is an issue.<a href="#section-1.3.1-4.2.2.5" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
<p id="section-1.3.1-5">The conclusion of these implementation details is that where DTLS
   in SCTP can use existing DTLS implementations, including OpenSSL's
   DTLS 1.2 implementation. It is not known if any DTLS stack exist
   that fully support the requirements in DTLS/SCTP. It is
   expected that a DTLS/SCTP implementation will have to also
   extend some DTLS implementation.<a href="#section-1.3.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="terminology">
<section id="section-1.4">
        <h3 id="name-terminology">
<a href="#section-1.4" class="section-number selfRef">1.4. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.4-1">This document uses the following terms:<a href="#section-1.4-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.4-2">
          <dt id="section-1.4-2.1">Association:</dt>
          <dd style="margin-left: 1.5em" id="section-1.4-2.2">
            <p id="section-1.4-2.2.1">An SCTP association.<a href="#section-1.4-2.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-2.3">Connection:</dt>
          <dd style="margin-left: 1.5em" id="section-1.4-2.4">
            <p id="section-1.4-2.4.1">A DTLS connection. It is uniquely identified by a
   connection identifier.<a href="#section-1.4-2.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.4-2.5">Stream:</dt>
          <dd style="margin-left: 1.5em" id="section-1.4-2.6">
            <p id="section-1.4-2.6.1">A unidirectional stream of an SCTP association.  It is
   uniquely identified by a stream identifier.<a href="#section-1.4-2.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="abbreviations">
<section id="section-1.5">
        <h3 id="name-abbreviations">
<a href="#section-1.5" class="section-number selfRef">1.5. </a><a href="#name-abbreviations" class="section-name selfRef">Abbreviations</a>
        </h3>
<span class="break"></span><dl class="dlParallel" id="section-1.5-1">
          <dt id="section-1.5-1.1">AEAD:</dt>
          <dd style="margin-left: 1.5em" id="section-1.5-1.2">
            <p id="section-1.5-1.2.1">Authenticated Encryption with Associated Data<a href="#section-1.5-1.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-1.3">DCI:</dt>
          <dd style="margin-left: 1.5em" id="section-1.5-1.4">
            <p id="section-1.5-1.4.1">DTLS Connection Index<a href="#section-1.5-1.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-1.5">DTLS:</dt>
          <dd style="margin-left: 1.5em" id="section-1.5-1.6">
            <p id="section-1.5-1.6.1">Datagram Transport Layer Security<a href="#section-1.5-1.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-1.7">MTU:</dt>
          <dd style="margin-left: 1.5em" id="section-1.5-1.8">
            <p id="section-1.5-1.8.1">Maximum Transmission Unit<a href="#section-1.5-1.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-1.9">PPID:</dt>
          <dd style="margin-left: 1.5em" id="section-1.5-1.10">
            <p id="section-1.5-1.10.1">Payload Protocol Identifier<a href="#section-1.5-1.10.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-1.11">SCTP:</dt>
          <dd style="margin-left: 1.5em" id="section-1.5-1.12">
            <p id="section-1.5-1.12.1">Stream Control Transmission Protocol<a href="#section-1.5-1.12.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-1.13">SCTP-AUTH:</dt>
          <dd style="margin-left: 1.5em" id="section-1.5-1.14">
            <p id="section-1.5-1.14.1">Authenticated Chunks for SCTP <span>[<a href="#RFC4895" class="cite xref">RFC4895</a>]</span><a href="#section-1.5-1.14.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.5-1.15">ULP:</dt>
          <dd style="margin-left: 1.5em" id="section-1.5-1.16">
            <p id="section-1.5-1.16.1">Upper Layer Protocol<a href="#section-1.5-1.16.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="conventions">
<section id="section-1.6">
        <h3 id="name-conventions">
<a href="#section-1.6" class="section-number selfRef">1.6. </a><a href="#name-conventions" class="section-name selfRef">Conventions</a>
        </h3>
<p id="section-1.6-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.6-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="dtls-identification">
<section id="section-2">
      <h2 id="name-dtls-identification">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-dtls-identification" class="section-name selfRef">DTLS Identification</a>
      </h2>
<p id="section-2-1">This section identifies how the extension described in this document
is identified in the Crypto Chunk and its negotiation
<span>[<a href="#I-D.westerlund-tsvwg-sctp-crypto-chunk" class="cite xref">I-D.westerlund-tsvwg-sctp-crypto-chunk</a>]</span>.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="new-protection-engines-protection-engines">
<section id="section-2.1">
        <h3 id="name-new-protection-engines-prot">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-new-protection-engines-prot" class="section-name selfRef">New protection Engines {protection-engines}</a>
        </h3>
<p id="section-2.1-1">This document specifies the adoption of DTLS as protection engine
for SCTP Crypto Chunks for DTLS1.2 and DTLS1.3<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">The following table applies.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<span id="name-dtls-protection-engines"></span><div id="dtls-protection-engines">
<table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-dtls-protection-engines" class="selfRef">DTLS protection engines</a>
          </caption>
<thead>
            <tr>
              <th class="text-right" rowspan="1" colspan="1">VALUE</th>
              <th class="text-left" rowspan="1" colspan="1">DTLS VERSION</th>
              <th class="text-left" rowspan="1" colspan="1">REFERENCE</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">DTLS 1.2</td>
              <td class="text-left" rowspan="1" colspan="1">RFC-To-Be</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">DTLS 1.3</td>
              <td class="text-left" rowspan="1" colspan="1">RFC-To-Be</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-2.1-4">The values specified above shall be used in the Protected Association
parameter as protection engines as specified in
<span>[<a href="#I-D.westerlund-tsvwg-sctp-crypto-chunk" class="cite xref">I-D.westerlund-tsvwg-sctp-crypto-chunk</a>]</span> and are registered with
IANA below in <a href="#iana-protection-engines" class="auto internal xref">Section 11.1</a>.<a href="#section-2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="dtls-usage-of-crypto-chunk">
<section id="section-3">
      <h2 id="name-dtls-usage-of-crypto-chunk">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-dtls-usage-of-crypto-chunk" class="section-name selfRef">DTLS Usage of CRYPTO Chunk</a>
      </h2>
<p id="section-3-1">DTLS in SCTP uses the CRYPTO chunk in the following way. Fields
   not discussed are used as specified in
   <span>[<a href="#I-D.westerlund-tsvwg-sctp-crypto-chunk" class="cite xref">I-D.westerlund-tsvwg-sctp-crypto-chunk</a>]</span>.<a href="#section-3-1" class="pilcrow">¶</a></p>
<span id="name-crypto-chunk-structure"></span><div id="sctp-CRYPTO-chunk-structure">
<figure id="figure-2">
        <div id="section-3-2.1">
          <div class="alignLeft art-svg artwork" id="section-3-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="208" width="528" viewBox="0 0 528 208" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px">
              <path d="M 8,64 L 8,192" fill="none" stroke="black"></path>
              <path d="M 136,64 L 136,96" fill="none" stroke="black"></path>
              <path d="M 232,64 L 232,96" fill="none" stroke="black"></path>
              <path d="M 264,64 L 264,96" fill="none" stroke="black"></path>
              <path d="M 264,160 L 264,192" fill="none" stroke="black"></path>
              <path d="M 520,64 L 520,192" fill="none" stroke="black"></path>
              <path d="M 8,64 L 520,64" fill="none" stroke="black"></path>
              <path d="M 8,96 L 520,96" fill="none" stroke="black"></path>
              <path d="M 264,160 L 520,160" fill="none" stroke="black"></path>
              <path d="M 8,192 L 520,192" fill="none" stroke="black"></path>
              <g class="text">
                <text x="16" y="36">0</text>
                <text x="176" y="36">1</text>
                <text x="336" y="36">2</text>
                <text x="496" y="36">3</text>
                <text x="16" y="52">0</text>
                <text x="32" y="52">1</text>
                <text x="48" y="52">2</text>
                <text x="64" y="52">3</text>
                <text x="80" y="52">4</text>
                <text x="96" y="52">5</text>
                <text x="112" y="52">6</text>
                <text x="128" y="52">7</text>
                <text x="144" y="52">8</text>
                <text x="160" y="52">9</text>
                <text x="176" y="52">0</text>
                <text x="192" y="52">1</text>
                <text x="208" y="52">2</text>
                <text x="224" y="52">3</text>
                <text x="240" y="52">4</text>
                <text x="256" y="52">5</text>
                <text x="272" y="52">6</text>
                <text x="288" y="52">7</text>
                <text x="304" y="52">8</text>
                <text x="320" y="52">9</text>
                <text x="336" y="52">0</text>
                <text x="352" y="52">1</text>
                <text x="368" y="52">2</text>
                <text x="384" y="52">3</text>
                <text x="400" y="52">4</text>
                <text x="416" y="52">5</text>
                <text x="432" y="52">6</text>
                <text x="448" y="52">7</text>
                <text x="464" y="52">8</text>
                <text x="480" y="52">9</text>
                <text x="496" y="52">0</text>
                <text x="512" y="52">1</text>
                <text x="36" y="84">Type</text>
                <text x="64" y="84">=</text>
                <text x="92" y="84">0x4x</text>
                <text x="184" y="84">Flags</text>
                <text x="248" y="84">DCI</text>
                <text x="360" y="84">Chunk</text>
                <text x="412" y="84">Length</text>
                <text x="264" y="132">Payload</text>
                <text x="384" y="180">Padding</text>
              </g>
            </svg><a href="#section-3-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-crypto-chunk-structure" class="selfRef">CRYPTO Chunk Structure</a>
        </figcaption></figure>
</div>
<span class="break"></span><dl class="dlNewline" id="section-3-3">
        <dt id="section-3-3.1">DCI: 2 bits (unsigned integer)</dt>
        <dd style="margin-left: 1.5em" id="section-3-3.2">
          <p id="section-3-3.2.1">DTLS Connection Index is the
   lower two bits of an DTLS Connection Index counter. This is a
   counter implemented in DTLS in SCTP that is used to identify which
   DTLS connection instance that is capable of processing any received
   packet. This counter is recommended to be 64-bit to guarantee no
   lifetime issues for the SCTP Association.<a href="#section-3-3.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-3.3">Flags: 6 bits</dt>
        <dd style="margin-left: 1.5em" id="section-3-3.4">
          <p id="section-3-3.4.1">Chunk Flag bits not currently used by DTLS in SCTP. They
   MUST be set to zero (0) and MUST be ignored on reception. They MAY
   be used in future updated specifications for DTLS in SCTP.<a href="#section-3-3.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-3-3.5">Payload: variable length</dt>
        <dd style="margin-left: 1.5em" id="section-3-3.6">
          <p id="section-3-3.6.1">One or more DTLS records. In cases more
   than one DTLS record is included all DTLS records except the last
   MUST include a length field. Note that this matches what is specified in
   DTLS 1.3 <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span> and DTLS 1.2 will always include the length
   field in each record.<a href="#section-3-3.6.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="crypto-chunk-integration">
<section id="section-4">
      <h2 id="name-crypto-chunk-integration">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-crypto-chunk-integration" class="section-name selfRef">Crypto Chunk Integration</a>
      </h2>
<p id="section-4-1">There are a set of requirements stated in <span>[<a href="#I-D.westerlund-tsvwg-sctp-crypto-chunk" class="cite xref">I-D.westerlund-tsvwg-sctp-crypto-chunk</a>]</span> that
need to be addressed in this specification, this section deals with those
requirements and how they are met in the current specification.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="state-machine">
<section id="section-4.1">
        <h3 id="name-state-machine">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-state-machine" class="section-name selfRef">State Machine</a>
        </h3>
<p id="section-4.1-1">The CRYPTO Chunk allows the protection engine to have inband or
out-of-band key establishment. DTLS in SCTP uses inband key
establishment, thus the DTLS handshake establishes shared keys with the
remote peer. As soon as the SCTP State Machine enters PROTECTION
PENDING state, DTLS is responsible for progressing to the PROTECTED
state when DTLS handshake has completed. The DCI counter is
initialized to the value zero that is used for the initial DTLS
handshake.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<div id="protection-pending-state">
<section id="section-4.1.1">
          <h4 id="name-protection-pending-state">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-protection-pending-state" class="section-name selfRef">PROTECTION PENDING state</a>
          </h4>
<p id="section-4.1.1-1">When entering PROTECTION PENDING state, DTLS will start the handshake
according to <a href="#dtls-handshake" class="auto internal xref">Section 6.1</a>.<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1.1-2">DTLS protection engine being initialized for a new SCTP association
will set the DCI counter = 0, which implies a DCI field value of 0,
for the initial DTLS connection. The DTLS handshake messages are
transmitted from this endpoint to the peer using DATA chunks with the
PPID value set to Protection Engine Protocol Identifier
<span>[<a href="#I-D.westerlund-tsvwg-sctp-crypto-chunk" class="cite xref">I-D.westerlund-tsvwg-sctp-crypto-chunk</a>]</span>.<a href="#section-4.1.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1.1-3">When a successful handshake has been completed, DTLS protection engine
will inform CRYPTO chunk Handler that will move SCTP State Machine
into PROTECTED state.<a href="#section-4.1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="protected-state">
<section id="section-4.1.2">
          <h4 id="name-protected-state">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-protected-state" class="section-name selfRef">PROTECTED state</a>
          </h4>
<p id="section-4.1.2-1">In the PROTECTED state the currently active DTLS connection is used
for protection operation of the payload of SCTP chunks in each packet
per below specification.  When necessary to meet requirements on
periodic re-authentication of the peer and establishment of new
forward secrecy keys a new parallel DTSL connection is established as
further specified in <a href="#parallel-dtls" class="auto internal xref">Section 8</a>.<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="shutdown-states">
<section id="section-4.1.3">
          <h4 id="name-shutdown-states">
<a href="#section-4.1.3" class="section-number selfRef">4.1.3. </a><a href="#name-shutdown-states" class="section-name selfRef">SHUTDOWN states</a>
          </h4>
<p id="section-4.1.3-1">When the SCTP association leaves the ESTABLISHED state per <span>[<a href="#RFC9260" class="cite xref">RFC9260</a>]</span>
to be shutdown the DTLS connection is kept and continues to protect
the SCTP packet payloads through the shutdown process.<a href="#section-4.1.3-1" class="pilcrow">¶</a></p>
<p id="section-4.1.3-2">When the association reaches the CLOSED state as part of the SCTP
association closing process all DTLS connections that existed are
terminated without further transmissions, i.e. DTLS close_notify is
not transmitted.<a href="#section-4.1.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="dtls-connection-handling">
<section id="section-4.2">
        <h3 id="name-dtls-connection-handling">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-dtls-connection-handling" class="section-name selfRef">DTLS Connection Handling</a>
        </h3>
<p id="section-4.2-1">It's up to DTLS protection engine to manage the DTLS connections and
their related DCI.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<div id="add-dtls-connection">
<section id="section-4.2.1">
          <h4 id="name-add-a-new-dtls-connection">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-add-a-new-dtls-connection" class="section-name selfRef">Add a New DTLS Connection</a>
          </h4>
<p id="section-4.2.1-1">Either peer can add a new DTLS connection to the SCTP association at
any time, but no more than 2 DTLS connections can exist at the same
time.  The new DCI value shall be the last active DCI increased by one
modulo 4, this makes the attempt to create a new DTLS connection to
use the same, known, value of DCI from both peers.  A new handshake
will be initiated by DTLS using the new DCI.  Details of the handshake
are described in <a href="#dtls-handshake" class="auto internal xref">Section 6.1</a>.<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.2.1-2">As either endpoint can initiate a DTLS handshake at the same time,
either endpoint may receive a DTLS ClientHello message when it has
sent its own ClientHello. In this case the ClientHello from the
endpoint that had the DTLS Client role in the establishment of the
previous DTLS connection shall be continued to be processed and the
other dropped.<a href="#section-4.2.1-2" class="pilcrow">¶</a></p>
<p id="section-4.2.1-3">When the handshake has been completed successfully, the new DTLS
connection will be possible to use for traffic, if the handshake is
not completed successfully, the new DCI value will not be considered
used and a next attempt will reuse that DCI.<a href="#section-4.2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="remove-dtls-connection">
<section id="section-4.2.2">
          <h4 id="name-remove-an-existing-dtls-con">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-remove-an-existing-dtls-con" class="section-name selfRef">Remove an existing DTLS Connection</a>
          </h4>
<p id="section-4.2.2-1">Either peers can initialize the removal of a DTLS connection from the
current SCTP association when it is no longer the active one, i.e. when a
newer DTLS connection is in use. It is RECOMMENDED to not initiate
removal until at least one SCTP packet protected by the new DTLS
connection has been received, and any transmitted packets protected
using the new DTLS connection has been acknowledge, alternatively one
Maximum Segment Lifetime (120 seconds) has passed since the last SCTP
packet protected by the old DTLS connection was transmitted.<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2.2-2">The closing of the DTLS connection when the SCTP association is in
PROTECTED and ESTABLISHED state is done by having the DTLS connection
send a DTLS close_notify. Note the difference in process for DTLS 1.2
and DTLS 1.3. Where sending the DTLS 1.2 close_notify will trigger an
immediate close also in the peer. Which is why it is recommended to
ensure that one have received packets from the peer using the new DTLS
connection.<a href="#section-4.2.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2.2-3">When DTLS closure for a DTLS connection is completed, the related DCI is
released in the DTLS protection engine.<a href="#section-4.2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="error-cases">
<section id="section-4.3">
        <h3 id="name-error-cases">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-error-cases" class="section-name selfRef">Error Cases</a>
        </h3>
<p id="section-4.3-1">As DTLS has its own error reporting mechanism by exchanging DTLS alert
messages no new DTLS related cause codes are defined to use the error
handling defined in <span>[<a href="#I-D.westerlund-tsvwg-sctp-crypto-chunk" class="cite xref">I-D.westerlund-tsvwg-sctp-crypto-chunk</a>]</span>.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">When DTLS encounters an error it may report that issue using DTLS
alert message to its peer by putting the created DTLS record in a
DATA chunk with Protection Engine PPID and sending it in an SCTP packet.
This is independent of what to do in relation to the SCTP association.
Depending on the severance of the error different paths can be the result:<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.3-3">
          <dt id="section-4.3-3.1">Non-critical:</dt>
          <dd style="margin-left: 1.5em" id="section-4.3-3.2">
            <p id="section-4.3-3.2.1">the DTLS connection can continue to protect
   the SCTP association. In this case the issue may be worth reporting
   to the peer using a DTLS alert message, but otherwise continue
   without further action.<a href="#section-4.3-3.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-3.3">Critical, but not immediately fatal:</dt>
          <dd style="margin-left: 1.5em" id="section-4.3-3.4">
            <p id="section-4.3-3.4.1">If the DTLS connection has a
   critical issue, but can still protect packets then a the endpoint
   SHOULD attempt to establish a new DTLS connection. If that succeeds
   then the SCTP association switches over to the new DTLS connection
   and can terminate the old one including reporting the error. In
   case the establishment fails, then this critical issue MUST be reported
   to the SCTP association so that it can send an ABORT chunk with the
   Error in Protection cause code. This will terminate the SCTP
   association immediately, provide ULP with notification of the
   failure and speeding up any higher layer management of the failure.<a href="#section-4.3-3.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-4.3-3.5">Critical, and immediately fatal:</dt>
          <dd style="margin-left: 1.5em" id="section-4.3-3.6">
            <p id="section-4.3-3.6.1">If the DTLS connection fails so
   that no further data can be protected (i.e. either sent or
   received) with maintained security then it is not possible to
   establish a new DTLS connection and the protection engine will
   have to indicate this to the SCTP implementation so it can perform
   a one sides SCTP association termination. This will lead to an
   eventual SCTP association timeout in the peer.<a href="#section-4.3-3.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="dtls-considerations">
<section id="section-5">
      <h2 id="name-dtls-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-dtls-considerations" class="section-name selfRef">DTLS Considerations</a>
      </h2>
<div id="version-of-dtls">
<section id="section-5.1">
        <h3 id="name-version-of-dtls">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-version-of-dtls" class="section-name selfRef">Version of DTLS</a>
        </h3>
<p id="section-5.1-1">This document defines the usage of either DTLS 1.3 <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span>, or
   DTLS 1.2 <span>[<a href="#RFC6347" class="cite xref">RFC6347</a>]</span>.  Earlier versions of DTLS MUST NOT be used
   (see <span>[<a href="#RFC8996" class="cite xref">RFC8996</a>]</span>).  DTLS 1.3 is RECOMMENDED for security and
   performance reasons.  It is expected that DTLS in SCTP as described in
   this document will work with future versions of DTLS.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">Only one version of DTLS MUST be used during the lifetime of an
   SCTP Association, meaning that the procedure for replacing the DTLS
   version in use requires the existing SCTP Association to be
   terminated and a new SCTP Association with the desired DTLS version
   to be instantiated.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="configuration-of-dtls">
<section id="section-5.2">
        <h3 id="name-configuration-of-dtls">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-configuration-of-dtls" class="section-name selfRef">Configuration of DTLS</a>
        </h3>
<div id="general">
<section id="section-5.2.1">
          <h4 id="name-general">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-general" class="section-name selfRef">General</a>
          </h4>
<p id="section-5.2.1-1">The DTLS Connection ID SHALL NOT be included in the DTLS records as
   it is not needed, the CRYPTO chunk indicates which DTLS connection
   the DTLS records are intended for using the DCI bits. Avoiding
   overhead and addition implementation requirements on DTLS
   implementation.<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.1-2">The DTLS record length field is normally not needed as the CRYPTO
   Chunk provides a length field unless multiple records are put in
   same chunk payload. If multiple DTLS records are included in one
   CRYPTO chunk payload the DTLS record length field MUST be present
   in all but the last.<a href="#section-5.2.1-2" class="pilcrow">¶</a></p>
<p id="section-5.2.1-3">DTLS record replay detection MUST be used.<a href="#section-5.2.1-3" class="pilcrow">¶</a></p>
<p id="section-5.2.1-4">Sequence number size can be adapted based on how quickly it wraps.<a href="#section-5.2.1-4" class="pilcrow">¶</a></p>
<p id="section-5.2.1-5">Many of the TLS registries have a "Recommended" column. Parameters
   not marked as "Y" are NOT RECOMMENDED to support in DTLS in
   SCTP. Non-AEAD cipher suites or cipher suites without
   confidentiality MUST NOT be supported. Cipher suites and parameters
   that do not provide ephemeral key exchange MUST NOT be supported.<a href="#section-5.2.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authentication-and-policy-decisions">
<section id="section-5.2.2">
          <h4 id="name-authentication-and-policy-d">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-authentication-and-policy-d" class="section-name selfRef">Authentication and Policy Decisions</a>
          </h4>
<p id="section-5.2.2-1">DTLS in SCTP MUST be mutually authenticated. Authentication is the
process of establishing the identity of a user or system and verifying
that the identity is valid. DTLS only provides proof of possession of
a key. DTLS in SCTP MUST perform identity authentication. It is
RECOMMENDED that DTLS in SCTP is used with certificate-based
authentication. When certificates are used the application using DTLS
in SCTP is responsible for certificate policies, certificate chain
validation, and identity authentication (HTTPS does for example match
the hostname with a subjectAltName of type dNSName). The application
using DTLS in SCTP defines what the identity is and how it is encoded
and the client and server MUST use the same identity format. Guidance
on server certificate validation can be found in
<span>[<a href="#I-D.ietf-uta-rfc6125bis" class="cite xref">I-D.ietf-uta-rfc6125bis</a>]</span>. DTLS in SCTP enables periodic transfer of
mutual revocation information (OSCP stapling) every time a new
parallel connection is set up. All security decisions MUST be based on
the peer's authenticated identity, not on its transport layer
identity.<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2.2-2">It is possible to authenticate DTLS endpoints based on IP addresses in
certificates. SCTP associations can use multiple IP addresses per SCTP
endpoint. Therefore, it is possible that DTLS records will be sent
from a different source IP address or to a different destination IP
address than that originally authenticated. This is not a problem
provided that no security decisions are made based on the source or
destination IP addresses.<a href="#section-5.2.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="new-connections">
<section id="section-5.2.3">
          <h4 id="name-new-connections">
<a href="#section-5.2.3" class="section-number selfRef">5.2.3. </a><a href="#name-new-connections" class="section-name selfRef">New Connections</a>
          </h4>
<p id="section-5.2.3-1">Implementations MUST set up new DTLS connections before any of the
certificates expire. It is RECOMMENDED that all negotiated and
exchanged parameters are the same except for the timestamps in the
certificates. Clients and servers MUST NOT accept a change of identity
during the setup of a new connections, but MAY accept negotiation of
stronger algorithms and security parameters, which might be motivated
by new attacks.<a href="#section-5.2.3-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3-2">Allowing new connections can enable denial-of-service attacks. The
endpoints MUST limit the number of simultaneous connections to two.<a href="#section-5.2.3-2" class="pilcrow">¶</a></p>
<p id="section-5.2.3-3">To force attackers to do dynamic key exfiltration and limits the
amount of compromised data due to key compromise implementations MUST
have policies for how often to set up new connections with ephemeral
key exchange such as ECDHE. Implementations SHOULD set up new
connections frequently to force attackers to dynamic key
extraction. E.g., at least every hour and every 100 GB of data which
is a common policy for IPsec <span>[<a href="#ANSSI-DAT-NT-003" class="cite xref">ANSSI-DAT-NT-003</a>]</span>. See
<span>[<a href="#I-D.ietf-tls-rfc8446bis" class="cite xref">I-D.ietf-tls-rfc8446bis</a>]</span> for a more detailed discussion on key
compromise and key exfiltration in (D)TLS.<a href="#section-5.2.3-3" class="pilcrow">¶</a></p>
<p id="section-5.2.3-4">For many DTLS in SCTP deployments the SCTP association is expected to
have a very long lifetime of months or even years. For associations
with such long lifetimes there is a need to frequently re-authenticate
both client and server by setting up new connections. TLS Certificate
lifetimes significantly shorter than a year are common which is
shorter than many expected SCTP associations protected by DTLS in
SCTP.<a href="#section-5.2.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="padding-of-dtls-records">
<section id="section-5.2.4">
          <h4 id="name-padding-of-dtls-records">
<a href="#section-5.2.4" class="section-number selfRef">5.2.4. </a><a href="#name-padding-of-dtls-records" class="section-name selfRef">Padding of DTLS Records</a>
          </h4>
<p id="section-5.2.4-1">Both SCTP and DTLS contains mechanisms to padd SCTP payloads, and DTLS
records respectively. If padding of SCTP packets are desired to hide
actual message sizes it RECOMMEDED to use the SCTP Padding Chunck
<span>[<a href="#RFC4820" class="cite xref">RFC4820</a>]</span> to generate a consisted SCTP payload size. Support of this
chunk is only required on the sender side. However, if the PAD chunk
is not supported DTLS padding MAY be used.<a href="#section-5.2.4-1" class="pilcrow">¶</a></p>
<p id="section-5.2.4-2">It needs to be noted that independent if SCTP padding or DTLS padding
is used the padding is not taken into account by the SCTP congestion
control. Extensive use of padding has potential for worsen congestion
situations as the SCTP association will consume more bandwidth than
its derived share by the congestion control.<a href="#section-5.2.4-2" class="pilcrow">¶</a></p>
<p id="section-5.2.4-3">The use of SCTP PAD chunk is recommened as it at least can enable
future extension or SCTP implementation that account also for the
padding. Use of DTLS padding hides this packet expansion from SCTP.<a href="#section-5.2.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dtls-12">
<section id="section-5.2.5">
          <h4 id="name-dtls-12">
<a href="#section-5.2.5" class="section-number selfRef">5.2.5. </a><a href="#name-dtls-12" class="section-name selfRef">DTLS 1.2</a>
          </h4>
<p id="section-5.2.5-1">The updates in Section 13 of <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span> SHALL be followed for DTLS
1.2. DTLS 1.2 MUST be configured to disable options known to provide
insufficient security. HTTP/2 <span>[<a href="#RFC9113" class="cite xref">RFC9113</a>]</span> gives good minimum
requirements based on the attacks that where publicly known in 2022.<a href="#section-5.2.5-1" class="pilcrow">¶</a></p>
<p id="section-5.2.5-2">The AEAD limits in DTLS 1.3 are equally valid for DTLS 1.2 and SHOULD
be followed for DTLS in SCTP, but are not mandated by the DTLS 1.2
specification.<a href="#section-5.2.5-2" class="pilcrow">¶</a></p>
<p id="section-5.2.5-3">Use of renegotiation is NOT RECOMMENDED as it is disables in many
implementations and does not provide any benefits in DTLS in SCTP
compared to setting up a new connection. Resumption MAY be used but
does not provide ephemeral key exchange as in DTLS 1.3<a href="#section-5.2.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dtls-13">
<section id="section-5.2.6">
          <h4 id="name-dtls-13">
<a href="#section-5.2.6" class="section-number selfRef">5.2.6. </a><a href="#name-dtls-13" class="section-name selfRef">DTLS 1.3</a>
          </h4>
<p id="section-5.2.6-1">DTLS 1.3 is preferred over DTLS 1.2 being a newer protocol that
addresses known vulnerabilities and only defines strong algorithms
without known major weaknesses at the time of publication.<a href="#section-5.2.6-1" class="pilcrow">¶</a></p>
<p id="section-5.2.6-2">DTLS 1.3 requires rekeying before algorithm specific AEAD limits have
been reached. Implementations MAY setup a new DTLS connection instead
of using key update.<a href="#section-5.2.6-2" class="pilcrow">¶</a></p>
<p id="section-5.2.6-3">In DTLS 1.3 any number of tickets can be issued in a connection and
the tickets can be used for resumption as long as they are valid,
which is up to seven days. The nodes in a resumed connection have the
same roles (client or server) as in the connection where the ticket
was issued. Resumption can have significant latency benefits for
quickly restarting a broken DTLS/SCTP association. If tickets and
resumption are used it is enough to issue a single ticket per
connection.<a href="#section-5.2.6-3" class="pilcrow">¶</a></p>
<p id="section-5.2.6-4">The PSK key exchange mode psk_ke MUST NOT be used as it does not
provide ephemeral key exchange.<a href="#section-5.2.6-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="establishing-dtls-in-sctp">
<section id="section-6">
      <h2 id="name-establishing-dtls-in-sctp">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-establishing-dtls-in-sctp" class="section-name selfRef">Establishing DTLS in SCTP</a>
      </h2>
<p id="section-6-1">This section specifies how DTLS in SCTP is established after
   Protected Association Parameter with DTLS 1.2 or DTLS 1.3 as
   protection engine has been negotiated in the Init and Init-ACK
   exchange per <span>[<a href="#I-D.westerlund-tsvwg-sctp-crypto-chunk" class="cite xref">I-D.westerlund-tsvwg-sctp-crypto-chunk</a>]</span>.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="dtls-handshake">
<section id="section-6.1">
        <h3 id="name-dtls-handshake">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-dtls-handshake" class="section-name selfRef">DTLS Handshake</a>
        </h3>
<div id="handshake-of-initial-dtls-connection">
<section id="section-6.1.1">
          <h4 id="name-handshake-of-initial-dtls-c">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-handshake-of-initial-dtls-c" class="section-name selfRef">Handshake of initial DTLS connection</a>
          </h4>
<p id="section-6.1.1-1">As soon the SCTP Association has entered the SCTP state PROTECTION
   PENDING as defined by <span>[<a href="#I-D.westerlund-tsvwg-sctp-crypto-chunk" class="cite xref">I-D.westerlund-tsvwg-sctp-crypto-chunk</a>]</span>
   the DTLS handshake procedure is initiated by the endpoint that
   has initiated the SCTP association.<a href="#section-6.1.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1.1-2">The DTLS endpoint will if necessary fragment the handshake into
   multiple records each meeting the known or set MTU limit of the
   path between SCTP endpoints. Each DTLS handshake message fragment
   is sent as a SCTP user message on the same stream where each
   message is configured for reliable and in-order delivery with the
   Protection Engine PPID.  The DTLS instance SHOULD NOT use DTLS
   retransmission to repair any packet losses of handshake message
   fragment. Note: If the DTLS implementation support configuring a
   MTU larger than the actual IP MTU it could be used as SCTP provides
   reliability and fragmentation.<a href="#section-6.1.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1.1-3">If the DTLS handshake is successful in establishing a security
   context to protect further communication and the peer identity is
   accepted then the SCTP association is informed that it can
   move to the PROTECTED state.<a href="#section-6.1.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1.1-4">If the DTLS handshake failed the SCTP association SHALL be aborted
   and an ERROR chunk with the Error in Protection error cause, with
   the appropriate extra error causes is generated, the right
   selection of "Error During Protection Handshake" or "Timeout During
   Protection Handshake or Validation".<a href="#section-6.1.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="handshake-of-further-dtls-connections">
<section id="section-6.1.2">
          <h4 id="name-handshake-of-further-dtls-c">
<a href="#section-6.1.2" class="section-number selfRef">6.1.2. </a><a href="#name-handshake-of-further-dtls-c" class="section-name selfRef">Handshake of further DTLS connections</a>
          </h4>
<p id="section-6.1.2-1">When the SCTP Association has entered the ESTABLISHED state,
   each of the endpoint can initiate an DTLS handshake.<a href="#section-6.1.2-1" class="pilcrow">¶</a></p>
<p id="section-6.1.2-2">The DTLS endpoint will if necessary fragment the handshake into
   multiple records each meeting the known or set MTU limit of the
   path between SCTP endpoints. Each DTLS handshake message fragment
   is sent as a SCTP user message on the same stream where each
   message is configured for reliable and in-order delivery with the
   Protection Engine PPID.  The DTLS instance SHOULD NOT use DTLS
   retransmission to repair any packet losses of handshake message
   fragment. Note: If the DTLS implementation support configuring a
   MTU larger than the actual IP MTU it could be used as SCTP provides
   reliability and fragmentation.<a href="#section-6.1.2-2" class="pilcrow">¶</a></p>
<p id="section-6.1.2-3">If the DTLS handshake failed the SCTP association SHALL generate
   an ERROR chunk with the Error in Protection error cause, with
   extra error causes "Error During Protection Handshake".<a href="#section-6.1.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="validation-against-downgrade-attacks">
<section id="section-6.2">
        <h3 id="name-validation-against-downgrad">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-validation-against-downgrad" class="section-name selfRef">Validation Against Downgrade Attacks</a>
        </h3>
<p id="section-6.2-1">When the SCTP association has entered the PROTECTED state after the
   DTLS handshake has completed, the protection against downgrade in
   the negotiation of protection engine is performed per
   <span>[<a href="#I-D.westerlund-tsvwg-sctp-crypto-chunk" class="cite xref">I-D.westerlund-tsvwg-sctp-crypto-chunk</a>]</span>. The PVALID chunk will
   sent as a DTLS protected CRYPTO chunk payload per
   <a href="#chunk-processing" class="auto internal xref">Section 7</a>, thus protecting the plain text chunk.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">If the validation completes successful the SCTP association will
   enter ESTABLISHED state. ULP data exchanges can now happen and
   will be protected together will all other SCTP packets.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="chunk-processing">
<section id="section-7">
      <h2 id="name-processing-a-crypto-chunk">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-processing-a-crypto-chunk" class="section-name selfRef">Processing a CRYPTO Chunk</a>
      </h2>
<div id="sending">
<section id="section-7.1">
        <h3 id="name-sending">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-sending" class="section-name selfRef">Sending</a>
        </h3>
<p id="section-7.1-1">CRYPTO chunk sending happens when SCTP requires transferring control
or DATA chunk(s) to the remote SCTP Endpoint.  For a proper handling, DCI
shall be set to an established instance of DTLS connection.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">SCTP Chunk handler will create the payload of a legacy SCTP packet
according to <span>[<a href="#RFC9260" class="cite xref">RFC9260</a>]</span> and any used SCTP extensions. Such payload
will assume a PMTU that is equal to the value computed by SCTP minus
the size of the CRYPTO Chunk header and DTLS record and authentication
tag overhead. It's up to SCTP Chunk Handler to implement all the SCTP
rules for bundling and retransmission mechanism.  Once ready, the
payload will be transferred to DTLS as a single array of bytes.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">Once DTLS has created the related DTLS record (or DTLS records), it
will transfer the encrypted data as an array of bytes to CRYPTO chunk
handler for encapsulation into a CRYPTO chunk and being forwarded to
the SCTP header handler for transmission.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
<p id="section-7.1-4">The interface between SCTP and DTLS related to SCTP Payload will need
to carefully evaluate the PMTU as seen by SCTP and DTLS so that each
payload generated by SCTP Chunk Handler will not cause the finished
SCTP packet to exceed the known path MTU unless it is a Path MTUD
discovery packet.<a href="#section-7.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="receiving">
<section id="section-7.2">
        <h3 id="name-receiving">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-receiving" class="section-name selfRef">Receiving</a>
        </h3>
<p id="section-7.2-1">When receiving an SCTP packet containing a CRYPTO Chunk it will
contain an payload of protected SCTP control or data chunks. Since
there's at most one CRYPTO Chunk per SCTP packet, the payload of that
chunk will be transferred to the proper DTLS instance according to DCI
for decryption and processing.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">As discussed in CRYPTO Chunk specification when receiving packets
certain meta data will be needed to associate with the protected
CRYPTO chunk payload for SCTP to correctly process it. This includes
packet size, source IP and arrival interface, i.e. path information,
and ECN bits.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
<p id="section-7.2-3">When DTLS processes a DTLS record with decryption and integrity
verification and that contains application data, it will output the
data as an array of bytes and transfer it back to the CRYPTO Handler
that delivers it for SCTP chunk handling.<a href="#section-7.2-3" class="pilcrow">¶</a></p>
<p id="section-7.2-4">SCTP Chunk handler will threat the array as the payload of an SCTP
packet, thus it will extract all the chunks and handle them according
to <span>[<a href="#RFC9260" class="cite xref">RFC9260</a>]</span> and any supported extension.<a href="#section-7.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="parallel-dtls">
<section id="section-8">
      <h2 id="name-parallel-dtls-rekeying">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-parallel-dtls-rekeying" class="section-name selfRef">Parallel DTLS Rekeying</a>
      </h2>
<p id="section-8-1">Rekeying in this specification is implemented by replacing the DTLS connection
getting old with a new one. This feature exploits the capability of parallel
DTLS connections and the possibility to add and remove DTLS connections
during the lifetime of the SCTP Association.<a href="#section-8-1" class="pilcrow">¶</a></p>
<div id="criteria-for-rekeying">
<section id="section-8.1">
        <h3 id="name-criteria-for-rekeying">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-criteria-for-rekeying" class="section-name selfRef">Criteria for Rekeying</a>
        </h3>
<p id="section-8.1-1">The criteria for rekeying may vary depending on the ULP requirement on
security properties, chosen cipher suits etc. Therefore it is assumed
that the implementation will be configurable by the ULP to meet its demand.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">Likely criteria to impact the need for rekeying through the usage of
new DTLS connection are:<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1-3.1">Maximum time since last authentication of the peer<a href="#section-8.1-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.1-3.2">Amount of data transferred since last forward secrecy preserving
rekeying<a href="#section-8.1-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-8.1-3.3">The cipher suit's maximum key usage being reached. Although for
DTLS 1.3 usage of the Key Update mechanism can generate new keys
without forward secrecy properties.<a href="#section-8.1-3.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="procedure-for-rekeying">
<section id="section-8.2">
        <h3 id="name-procedure-for-rekeying">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-procedure-for-rekeying" class="section-name selfRef">Procedure for Rekeying</a>
        </h3>
<p id="section-8.2-1">This specification allows up to 2 DTLS connection to be active at the same
time for the current SCTP Association.
The following state machine applies.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<span id="name-state-diagram-for-rekeying"></span><div id="dtls-rekeying-state-diagram">
<figure id="figure-3">
          <div id="section-8.2-2.1">
            <div class="alignLeft art-svg artwork" id="section-8.2-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="560" width="472" viewBox="0 0 472 560" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px">
                <path d="M 8,48 L 8,528" fill="none" stroke="black"></path>
                <path d="M 96,32 L 96,64" fill="none" stroke="black"></path>
                <path d="M 96,144 L 96,176" fill="none" stroke="black"></path>
                <path d="M 96,240 L 96,272" fill="none" stroke="black"></path>
                <path d="M 96,336 L 96,368" fill="none" stroke="black"></path>
                <path d="M 96,448 L 96,480" fill="none" stroke="black"></path>
                <path d="M 136,64 L 136,136" fill="none" stroke="black"></path>
                <path d="M 136,176 L 136,232" fill="none" stroke="black"></path>
                <path d="M 136,272 L 136,328" fill="none" stroke="black"></path>
                <path d="M 136,368 L 136,440" fill="none" stroke="black"></path>
                <path d="M 136,480 L 136,528" fill="none" stroke="black"></path>
                <path d="M 176,32 L 176,64" fill="none" stroke="black"></path>
                <path d="M 176,144 L 176,176" fill="none" stroke="black"></path>
                <path d="M 176,240 L 176,272" fill="none" stroke="black"></path>
                <path d="M 176,336 L 176,368" fill="none" stroke="black"></path>
                <path d="M 176,448 L 176,480" fill="none" stroke="black"></path>
                <path d="M 96,32 L 176,32" fill="none" stroke="black"></path>
                <path d="M 8,48 L 88,48" fill="none" stroke="black"></path>
                <path d="M 96,64 L 176,64" fill="none" stroke="black"></path>
                <path d="M 96,144 L 176,144" fill="none" stroke="black"></path>
                <path d="M 96,176 L 176,176" fill="none" stroke="black"></path>
                <path d="M 96,240 L 176,240" fill="none" stroke="black"></path>
                <path d="M 96,272 L 176,272" fill="none" stroke="black"></path>
                <path d="M 96,336 L 176,336" fill="none" stroke="black"></path>
                <path d="M 96,368 L 176,368" fill="none" stroke="black"></path>
                <path d="M 96,448 L 176,448" fill="none" stroke="black"></path>
                <path d="M 96,480 L 176,480" fill="none" stroke="black"></path>
                <path d="M 8,528 L 136,528" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="144,440 132,434.4 132,445.6" fill="black" transform="rotate(90,136,440)"></polygon>
                <polygon class="arrowhead" points="144,328 132,322.4 132,333.6" fill="black" transform="rotate(90,136,328)"></polygon>
                <polygon class="arrowhead" points="144,232 132,226.4 132,237.6" fill="black" transform="rotate(90,136,232)"></polygon>
                <polygon class="arrowhead" points="144,136 132,130.4 132,141.6" fill="black" transform="rotate(90,136,136)"></polygon>
                <polygon class="arrowhead" points="96,48 84,42.4 84,53.6" fill="black" transform="rotate(0,88,48)"></polygon>
                <g class="text">
                  <text x="136" y="52">YOUNG</text>
                  <text x="224" y="52">There's</text>
                  <text x="276" y="52">only</text>
                  <text x="312" y="52">one</text>
                  <text x="212" y="68">DTLS</text>
                  <text x="276" y="68">connection</text>
                  <text x="344" y="68">until</text>
                  <text x="216" y="84">aging</text>
                  <text x="276" y="84">criteria</text>
                  <text x="328" y="84">are</text>
                  <text x="360" y="84">met</text>
                  <text x="96" y="116">AGING</text>
                  <text x="180" y="116">REMOTE</text>
                  <text x="232" y="116">AGING</text>
                  <text x="132" y="164">AGED</text>
                  <text x="212" y="164">When</text>
                  <text x="244" y="164">in</text>
                  <text x="276" y="164">AGED</text>
                  <text x="320" y="164">state</text>
                  <text x="352" y="164">a</text>
                  <text x="208" y="180">new</text>
                  <text x="244" y="180">DTLS</text>
                  <text x="308" y="180">connection</text>
                  <text x="204" y="196">is</text>
                  <text x="240" y="196">added</text>
                  <text x="284" y="196">with</text>
                  <text x="312" y="196">a</text>
                  <text x="336" y="196">new</text>
                  <text x="368" y="196">DCI</text>
                  <text x="72" y="212">NEW</text>
                  <text x="108" y="212">DTLS</text>
                  <text x="136" y="260">OLD</text>
                  <text x="204" y="260">In</text>
                  <text x="232" y="260">OLD</text>
                  <text x="272" y="260">state</text>
                  <text x="320" y="260">there</text>
                  <text x="208" y="276">are</text>
                  <text x="232" y="276">2</text>
                  <text x="268" y="276">active</text>
                  <text x="316" y="276">DTLS</text>
                  <text x="384" y="276">connections</text>
                  <text x="224" y="292">Traffic</text>
                  <text x="268" y="292">is</text>
                  <text x="316" y="292">switched</text>
                  <text x="364" y="292">to</text>
                  <text x="392" y="292">the</text>
                  <text x="424" y="292">new</text>
                  <text x="456" y="292">one</text>
                  <text x="84" y="308">SWITCH</text>
                  <text x="136" y="356">DRAIN</text>
                  <text x="208" y="356">The</text>
                  <text x="244" y="356">aged</text>
                  <text x="284" y="356">DTLS</text>
                  <text x="348" y="356">connection</text>
                  <text x="204" y="372">is</text>
                  <text x="248" y="372">drained</text>
                  <text x="308" y="372">before</text>
                  <text x="360" y="372">being</text>
                  <text x="408" y="372">ready</text>
                  <text x="204" y="388">to</text>
                  <text x="228" y="388">be</text>
                  <text x="268" y="388">closed</text>
                  <text x="96" y="420">DRAINED</text>
                  <text x="164" y="420">DTLS</text>
                  <text x="236" y="420">close_notify</text>
                  <text x="132" y="468">DEAD</text>
                  <text x="204" y="468">In</text>
                  <text x="236" y="468">DEAD</text>
                  <text x="280" y="468">state</text>
                  <text x="320" y="468">the</text>
                  <text x="356" y="468">aged</text>
                  <text x="236" y="484">connection</text>
                  <text x="292" y="484">is</text>
                  <text x="332" y="484">closed</text>
                  <text x="88" y="516">REMOVED</text>
                </g>
              </svg><a href="#section-8.2-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-state-diagram-for-rekeying" class="selfRef">State Diagram for Rekeying</a>
          </figcaption></figure>
</div>
<p id="section-8.2-3">Trigger for rekeying can either be a local AGING event, triggered by
the DTLS connection meeting the criteria for rekeying, or a REMOTE AGING
event, triggered by receiving a DTLS record on the DCI that would be
used for new DTLS connection. In such case a new DTLS connection
shall be added according to <a href="#add-dtls-connection" class="auto internal xref">Section 4.2.1</a> with a new DCI.<a href="#section-8.2-3" class="pilcrow">¶</a></p>
<p id="section-8.2-4">As soon as the new DTLS connection completes handshaking, the traffic is moved
from the old one, then the procedure for closing the old DTLS connection is
initiated, see <a href="#remove-dtls-connection" class="auto internal xref">Section 4.2.2</a>.<a href="#section-8.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="race-condition-in-rekeying">
<section id="section-8.3">
        <h3 id="name-race-condition-in-rekeying">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-race-condition-in-rekeying" class="section-name selfRef">Race Condition in Rekeying</a>
        </h3>
<p id="section-8.3-1">A race condition may happen when both peer experience local AGING event at
the same time and start creation of a new DTLS connection.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<p id="section-8.3-2">Since the criteria for calculating a new DCI is known and specified in
<a href="#add-dtls-connection" class="auto internal xref">Section 4.2.1</a>, the peers will use the same DCI for
identifying the new DTLS connection. And the race condition is solved
as specified in <a href="#add-dtls-connection" class="auto internal xref">Section 4.2.1</a>.<a href="#section-8.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="pmtu-discovery-considerations">
<section id="section-9">
      <h2 id="name-pmtu-discovery-consideratio">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-pmtu-discovery-consideratio" class="section-name selfRef">PMTU Discovery Considerations</a>
      </h2>
<p id="section-9-1">Due to the DTLS record limitation for application data SCTP MUST use
2<sup>14</sup> as input to determine absolute maximum MTU when running
PMTUD and using DTLS in SCTP as protection engine.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">The DTLS protection engine MUST provide its maximum overhead for DTLS
records and authentication tags when protecting the SCTP payload. This
so that SCTP PMTUD can take this into consideration and ensure that
produced packets that are not PMTUD probes does not become oversized.
This may require updating during the SCTP associations lifetime due to
future handshakes affecting cipher suit in use, or changes to record layer
configurations.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">Note that this implies that DTLS protection engine is expected to
accept application data payloads of potentially larger sizes than what
it configured to use for messages the DTLS implementation generates
itself for signaling.<a href="#section-9-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-10">
      <h2 id="name-security-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="general-1">
<section id="section-10.1">
        <h3 id="name-general-2">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-general-2" class="section-name selfRef">General</a>
        </h3>
<p id="section-10.1-1">The security considerations given in <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span>, <span>[<a href="#RFC6347" class="cite xref">RFC6347</a>]</span>, and
<span>[<a href="#RFC9260" class="cite xref">RFC9260</a>]</span> also apply to this document. BCP 195 <span>[<a href="#RFC9325" class="cite xref">RFC9325</a>]</span>
          <span>[<a href="#RFC8996" class="cite xref">RFC8996</a>]</span> provides recommendations and requirements for improving
the security of deployed services that use DTLS. BCP 195 MUST be
followed which implies that DTLS 1.0 SHALL NOT be supported and are
therefore not defined.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="privacy-considerations">
<section id="section-10.2">
        <h3 id="name-privacy-considerations">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
        </h3>
<p id="section-10.2-1">Although DTLS in SCTP provides privacy for the actual user message as
well as almost all chunks, some fields are not confidentiality
protected.  In addition to the DTLS record header, the SCTP common
header and the CRYPTO chunk header are not confidentiality
protected. An attacker can correlate DTLS connections over the same
SCTP association using the SCTP common header.<a href="#section-10.2-1" class="pilcrow">¶</a></p>
<p id="section-10.2-2">To provide identity protection it is RECOMMENDED that DTLS in SCTP is
used with certificate-based authentication in DTLS 1.3 <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span> and
to not reuse tickets.  DTLS 1.2 and DTLS 1.3 with external PSK
authentication does not provide identity protection.<a href="#section-10.2-2" class="pilcrow">¶</a></p>
<p id="section-10.2-3">By mandating ephemeral key exchange and cipher suites with
confidentiality DTLS in SCTP effectively mitigate many forms of
passive pervasive monitoring.  By recommending implementations to
frequently set up new DTLS connections with (EC)DHE force attackers to
do dynamic key exfiltration and limits the amount of compromised data
due to key compromise.<a href="#section-10.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-consideration">
<section id="section-11">
      <h2 id="name-iana-consideration">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-iana-consideration" class="section-name selfRef">IANA Consideration</a>
      </h2>
<p id="section-11-1">This document adds the two new entries listed in
<a href="#dtls-protection-engines" class="auto internal xref">Table 1</a> into the "CRYPTO Chunk Protection
Engine Identifiers" registry in the Stream Control Transmission
Protocol (SCTP) Parameters grouping.<a href="#section-11-1" class="pilcrow">¶</a></p>
<div id="iana-protection-engines">
<section id="section-11.1">
        <h3 id="name-protection-engine-registrat">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-protection-engine-registrat" class="section-name selfRef">Protection Engine Registration</a>
        </h3>
<p id="section-11.1-1">IANA is requested to register two Protection Engine Identifiers in the
"CRYPTO Chunk Protection Engine Identifiers" registry defined by
<span>[<a href="#I-D.westerlund-tsvwg-sctp-crypto-chunk" class="cite xref">I-D.westerlund-tsvwg-sctp-crypto-chunk</a>]</span>. The entries to be
registered are provided in <a href="#iana-protection-engines-table" class="auto internal xref">Table 2</a>.<a href="#section-11.1-1" class="pilcrow">¶</a></p>
<span id="name-crypto-chunk-protection-eng"></span><div id="iana-protection-engines-table">
<table class="center" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-crypto-chunk-protection-eng" class="selfRef">CRYPTO Chunk protection engines</a>
          </caption>
<thead>
            <tr>
              <th class="text-right" rowspan="1" colspan="1">ID VALUE</th>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
              <th class="text-left" rowspan="1" colspan="1">Contact</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">DTLS 1.2</td>
              <td class="text-left" rowspan="1" colspan="1">RFC-To-Be</td>
              <td class="text-left" rowspan="1" colspan="1">Authors</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">DTLS 1.3</td>
              <td class="text-left" rowspan="1" colspan="1">RFC-To-Be</td>
              <td class="text-left" rowspan="1" colspan="1">Authors</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
</section>
</div>
<section id="section-12">
      <h2 id="name-references">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-12.1">
        <h3 id="name-normative-references">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC4820">[RFC4820]</dt>
        <dd>
<span class="refAuthor">Tuexen, M.</span>, <span class="refAuthor">Stewart, R.</span>, and <span class="refAuthor">P. Lei</span>, <span class="refTitle">"Padding Chunk and Parameter for the Stream Control Transmission Protocol (SCTP)"</span>, <span class="seriesInfo">RFC 4820</span>, <span class="seriesInfo">DOI 10.17487/RFC4820</span>, <time datetime="2007-03" class="refDate">March 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4820">https://www.rfc-editor.org/info/rfc4820</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6347">[RFC6347]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span> and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"Datagram Transport Layer Security Version 1.2"</span>, <span class="seriesInfo">RFC 6347</span>, <span class="seriesInfo">DOI 10.17487/RFC6347</span>, <time datetime="2012-01" class="refDate">January 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6347">https://www.rfc-editor.org/info/rfc6347</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8996">[RFC8996]</dt>
        <dd>
<span class="refAuthor">Moriarty, K.</span> and <span class="refAuthor">S. Farrell</span>, <span class="refTitle">"Deprecating TLS 1.0 and TLS 1.1"</span>, <span class="seriesInfo">BCP 195</span>, <span class="seriesInfo">RFC 8996</span>, <span class="seriesInfo">DOI 10.17487/RFC8996</span>, <time datetime="2021-03" class="refDate">March 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8996">https://www.rfc-editor.org/info/rfc8996</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9113">[RFC9113]</dt>
        <dd>
<span class="refAuthor">Thomson, M., Ed.</span> and <span class="refAuthor">C. Benfield, Ed.</span>, <span class="refTitle">"HTTP/2"</span>, <span class="seriesInfo">RFC 9113</span>, <span class="seriesInfo">DOI 10.17487/RFC9113</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9113">https://www.rfc-editor.org/info/rfc9113</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9147">[RFC9147]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"The Datagram Transport Layer Security (DTLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 9147</span>, <span class="seriesInfo">DOI 10.17487/RFC9147</span>, <time datetime="2022-04" class="refDate">April 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9147">https://www.rfc-editor.org/info/rfc9147</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9325">[RFC9325]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span>, <span class="refAuthor">Saint-Andre, P.</span>, and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"Recommendations for Secure Use of Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">BCP 195</span>, <span class="seriesInfo">RFC 9325</span>, <span class="seriesInfo">DOI 10.17487/RFC9325</span>, <time datetime="2022-11" class="refDate">November 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9325">https://www.rfc-editor.org/info/rfc9325</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9260">[RFC9260]</dt>
        <dd>
<span class="refAuthor">Stewart, R.</span>, <span class="refAuthor">Tüxen, M.</span>, and <span class="refAuthor">K. Nielsen</span>, <span class="refTitle">"Stream Control Transmission Protocol"</span>, <span class="seriesInfo">RFC 9260</span>, <span class="seriesInfo">DOI 10.17487/RFC9260</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9260">https://www.rfc-editor.org/info/rfc9260</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.westerlund-tsvwg-sctp-crypto-chunk">[I-D.westerlund-tsvwg-sctp-crypto-chunk]</dt>
        <dd>
<span class="refAuthor">Westerlund, M.</span>, <span class="refAuthor">Preuß Mattsson, J.</span>, and <span class="refAuthor">C. Porfiri</span>, <span class="refTitle">"Stream Control Transmission Protocol (SCTP) CRYPTO chunk"</span>, <time datetime="2022-12" class="refDate">December 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org">https://datatracker.ietf.org</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-12.2">
        <h3 id="name-informative-references">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC3758">[RFC3758]</dt>
        <dd>
<span class="refAuthor">Stewart, R.</span>, <span class="refAuthor">Ramalho, M.</span>, <span class="refAuthor">Xie, Q.</span>, <span class="refAuthor">Tuexen, M.</span>, and <span class="refAuthor">P. Conrad</span>, <span class="refTitle">"Stream Control Transmission Protocol (SCTP) Partial Reliability Extension"</span>, <span class="seriesInfo">RFC 3758</span>, <span class="seriesInfo">DOI 10.17487/RFC3758</span>, <time datetime="2004-05" class="refDate">May 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3758">https://www.rfc-editor.org/info/rfc3758</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4895">[RFC4895]</dt>
        <dd>
<span class="refAuthor">Tuexen, M.</span>, <span class="refAuthor">Stewart, R.</span>, <span class="refAuthor">Lei, P.</span>, and <span class="refAuthor">E. Rescorla</span>, <span class="refTitle">"Authenticated Chunks for the Stream Control Transmission Protocol (SCTP)"</span>, <span class="seriesInfo">RFC 4895</span>, <span class="seriesInfo">DOI 10.17487/RFC4895</span>, <time datetime="2007-08" class="refDate">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4895">https://www.rfc-editor.org/info/rfc4895</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5061">[RFC5061]</dt>
        <dd>
<span class="refAuthor">Stewart, R.</span>, <span class="refAuthor">Xie, Q.</span>, <span class="refAuthor">Tuexen, M.</span>, <span class="refAuthor">Maruyama, S.</span>, and <span class="refAuthor">M. Kozuka</span>, <span class="refTitle">"Stream Control Transmission Protocol (SCTP) Dynamic Address Reconfiguration"</span>, <span class="seriesInfo">RFC 5061</span>, <span class="seriesInfo">DOI 10.17487/RFC5061</span>, <time datetime="2007-09" class="refDate">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5061">https://www.rfc-editor.org/info/rfc5061</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6083">[RFC6083]</dt>
        <dd>
<span class="refAuthor">Tuexen, M.</span>, <span class="refAuthor">Seggelmann, R.</span>, and <span class="refAuthor">E. Rescorla</span>, <span class="refTitle">"Datagram Transport Layer Security (DTLS) for Stream Control Transmission Protocol (SCTP)"</span>, <span class="seriesInfo">RFC 6083</span>, <span class="seriesInfo">DOI 10.17487/RFC6083</span>, <time datetime="2011-01" class="refDate">January 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6083">https://www.rfc-editor.org/info/rfc6083</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-tls-rfc8446bis">[I-D.ietf-tls-rfc8446bis]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-rfc8446bis-07</span>, <time datetime="2023-03-26" class="refDate">26 March 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-tls-rfc8446bis-07">https://datatracker.ietf.org/doc/html/draft-ietf-tls-rfc8446bis-07</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-tsvwg-dtls-over-sctp-bis">[I-D.ietf-tsvwg-dtls-over-sctp-bis]</dt>
        <dd>
<span class="refAuthor">Westerlund, M.</span>, <span class="refAuthor">Mattsson, J. P.</span>, and <span class="refAuthor">C. Porfiri</span>, <span class="refTitle">"Datagram Transport Layer Security (DTLS) over Stream Control Transmission Protocol (SCTP)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tsvwg-dtls-over-sctp-bis-06</span>, <time datetime="2023-04-24" class="refDate">24 April 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-tsvwg-dtls-over-sctp-bis-06">https://datatracker.ietf.org/doc/html/draft-ietf-tsvwg-dtls-over-sctp-bis-06</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-uta-rfc6125bis">[I-D.ietf-uta-rfc6125bis]</dt>
        <dd>
<span class="refAuthor">Saint-Andre, P.</span> and <span class="refAuthor">R. Salz</span>, <span class="refTitle">"Service Identity in TLS"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-uta-rfc6125bis-13</span>, <time datetime="2023-06-19" class="refDate">19 June 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-uta-rfc6125bis-13">https://datatracker.ietf.org/doc/html/draft-ietf-uta-rfc6125bis-13</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ANSSI-DAT-NT-003">[ANSSI-DAT-NT-003]</dt>
      <dd>
<span class="refAuthor">Agence nationale de la sécurité des systèmes d'information</span>, <span class="refTitle">"Recommendations for securing networks with IPsec"</span>, <span class="seriesInfo">ANSSI Technical Report DAT-NT-003 </span>, <time datetime="2015-08" class="refDate">August 2015</time>, <span>&lt;<a href="&lt;https://www.ssi.gouv.fr/uploads/2015/09/NT_IPsec_EN.pdf&gt;">&lt;https://www.ssi.gouv.fr/uploads/2015/09/NT_IPsec_EN.pdf&gt;</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Magnus Westerlund</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:magnus.westerlund@ericsson.com" class="email">magnus.westerlund@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">John Preuß Mattsson</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:john.mattsson@ericsson.com" class="email">john.mattsson@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Claudio Porfiri</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:claudio.porfiri@ericsson.com" class="email">claudio.porfiri@ericsson.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
